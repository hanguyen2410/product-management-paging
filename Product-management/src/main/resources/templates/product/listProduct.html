<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Style CSS -->
    <th:block th:replace="layout/head :: head"></th:block>
    <title>Customer Management</title>
    <style>

    </style>
</head>

<body>

<div class="iq-top-navbar">
    <div class="iq-navbar-custom">
        <nav class="navbar navbar-expand-lg navbar-light p-0">
<!--            <div class="iq-search-bar">-->
<!--                <form action="#" class="searchbox">-->
<!--                    <input type="text" class="text search-input" placeholder="Type here to search...">-->
<!--                </form>-->
<!--            </div>-->
            <button class="navbar-toggler" type="button" data-toggle="collapse"
                    data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-label="Toggle navigation">
                <i class="ri-menu-3-line"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">

            </div>
            <ul class="navbar-list">
                <li class="line-height">
                    <a href="#" class="search-toggle iq-waves-effect d-flex align-items-center">
                        <img src="/assets/assetsCP/anh/avatar.png" class="img-fluid rounded mr-3" alt="user">
                        <div class="caption">
                            <h6 class="mb-0 line-height">Hello: Hà Nguyễn</h6>
                            <p class="mb-0">ADMIN</p>
                        </div>
                    </a>
                    <div class="iq-sub-dropdown iq-user-dropdown">
                        <div class="iq-card shadow-none m-0">
                            <div class="iq-card-body p-0 ">
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </nav>
    </div>
</div>
<div class="iq-sidebar">
    <div class="iq-navbar-logo d-flex justify-content-between">
        <a href="" class="header-logo">
            <img src="/assets/assetsCP/anh/logo.png" class="img-fluid rounded" alt="">
            <span>Vững Huế</span>
        </a>
        <div class="iq-menu-bt align-self-center">
            <div class="wrapper-menu">
                <div class="main-circle"><i class="ri-menu-line"></i></div>
                <div class="hover-circle"><i class="ri-close-fill"></i></div>
            </div>
        </div>
    </div>
    <div id="sidebar-scrollbar" style="overflow: hidden; outline: none;" tabindex="-1" data-scrollbar="true">
        <div class="scroll-content">
            <div class="scroll-content"></div>
        </div>
        <nav class="iq-sidebar-menu">
            <ul id="iq-sidebar-toggle" class="iq-menu">
                <li>
                    <a href="#dashboard" class="iq-waves-effect" data-toggle="collapse" aria-expanded="false"><span
                            class="ripple rippleEffect"></span><i
                            class="las la-home iq-arrow-left"></i><span>Product</span><i
                            class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                    <ul id="dashboard" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                        <li><a href="/cp/products"><i class="las la-laptop-code"></i>List Prodcut</a></li>
                        <li><a href="/cp/products/create"><i class="las la-laptop-code"></i>Create Product</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div class="p-3"></div>
    </div>
</div>

<div id="content-page" class="content-page">
    <div id="div-count-fruit" class="row">
        <div class="col-sm-6 col-md-6 col-lg-2">
            <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                <div class="iq-card-body iq-box-relative">
                    <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                        <i class="ri-focus-2-line"></i>
                    </div>
                    <p class="text-secondary">Total Fruits</p>
                    <div class="d-flex align-items-center justify-content-between">
                        <h6>
                            <b><span id="countFruit"></span></b>
                        </h6>
                        <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countFruit.jpg">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-md-6 col-lg-2">
            <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                <div class="iq-card-body iq-box-relative">
                    <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                        <i class="ri-focus-2-line"></i>
                    </div>
                    <p class="text-secondary">Total Vegetables</p>
                    <div class="d-flex align-items-center justify-content-between" >
                        <h6>
                            <b><span id="countVegetable"></span></b>
                        </h6>
                        <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countVegetable.jpg" >

                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-md-6 col-lg-2">
            <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                <div class="iq-card-body iq-box-relative">
                    <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                        <i class="ri-focus-2-line"></i>
                    </div>
                    <p class="text-secondary">Total Meats</p>
                    <div class="d-flex align-items-center justify-content-between" >
                        <h6>
                            <b><span id="countMeat"></span></b>
                        </h6>
                        <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countMeat.jpg" >

                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-md-6 col-lg-2">
            <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                <div class="iq-card-body iq-box-relative">
                    <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                        <i class="ri-focus-2-line"></i>
                    </div>
                    <p class="text-secondary">Total Juices</p>
                    <div class="d-flex align-items-center justify-content-between" >
                        <h6>
                            <b><span id="countJuice"></span></b>
                        </h6>
                        <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countJuice.jpg" >

                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-md-6 col-lg-2">
            <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                <div class="iq-card-body iq-box-relative">
                    <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                        <i class="ri-focus-2-line"></i>
                    </div>
                    <p class="text-secondary">Total SeaFoods</p>
                    <div class="d-flex align-items-center justify-content-between" >
                        <h6>
                            <b><span id="countSeaFood"></span></b>
                        </h6>
                        <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countSeaFood.jpg">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-md-6 col-lg-2">
            <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                <div class="iq-card-body iq-box-relative">
                    <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                        <i class="ri-focus-2-line"></i>
                    </div>
                    <p class="text-secondary">Total Products</p>
                    <div class="d-flex align-items-center justify-content-between" >
                        <h6>
                            <b><span id="countTotalFood"></span></b>
                        </h6>
                        <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/logo.png">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-12">
        <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
            <div class="iq-card-header d-flex justify-content-between">
                <div class="iq-header-title">
                    <h4 class="card-title">Customer Management</h4>

                </div>
                <div>
                    <button class="btn btn-success fl-r create"><i class="fa fa-plus"></i>
                        Add New Customer
                    </button>
                </div>
            </div>
            <div class="iq-search-bar">
                <div>
                    <form action="#" class="searchbox">
                        <div>
                            <input type="text" id="search" class="text search-input" placeholder="Type here to search...">

                        </div>
                            <div>
                                <button class="btn btn-dark" id="btnSearch"><i class="fa fa-search"></i>
                                    Search
                                </button>
                            </div>
                    </form>
                </div>


                <div>
                    <select class="btn btn-outline-primary" id="filter">

                    </select>
                </div>

            </div>
            <div class="iq-card-body">
                <div class="table-responsive">
                    <table class="table mb-0 dataTable" id="listProduct">
                        <thead class="thead-light">
                        <tr class="bg-info text-white">
                            <th class="text-center sorting_asc" id="sortId">ID</th>
                            <th class="text-center">IMAGE</th>
                            <th class="text-center sorting_asc" id="sortProductName">Product Name <i class="fa fa-sort-alpha-asc" style="font-size: 15px" aria-hidden="false"></i></th>
                            <th class="text-center sorting_asc" id="sortPrice">Price (1Kg)</th>
                            <th class="text-center sorting_asc" id="sortQuantity">Quantity (Kg)<i class="fa fa-sort-alpha-asc" style="font-size: 15px" aria-hidden="false"></i></th>
                            <th class="text-center">Category</th>
                            <th class="text-center">Description</th>
                            <th class="text-center">Thao Tác</th>
                        </tr>
                        </thead>
                        <tbody>


                        </tbody>
                    </table>
                    <nav aria-label="...">
                        <ul class="pagination">
<!--                            <li class="page-item disabled">-->
<!--                                <span class="page-link">Previous</span>-->
<!--                            </li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">1</a></li>-->
<!--                            <li class="page-item active">-->
<!--                             <span class="page-link">2-->
<!--                            <span class="sr-only">(current)</span>-->
<!--                             </span>-->
<!--                            </li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">3</a></li>-->
<!--                            <li class="page-item">-->
<!--                                <a class="page-link" href="#">Next</a>-->
<!--                            </li>-->
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>


<footer class="footer">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-6">
                <ul class="list-inline mb-0">
                    <li class="list-inline-item"><a href="">Privacy Policy</a></li>
                    <li class="list-inline-item"><a href="">Terms of Use</a></li>
                </ul>
            </div>
            <div class="col-lg-6 text-right">
                Copyright 2020 <a href="#">FinDash</a> All Rights Reserved.
            </div>
        </div>
    </div>
</footer>

<th:block th:replace="product/modalCreateProduct :: modalCreateProduct"/>
<th:block th:replace="product/modalUpdateProduct :: modalUpdateProduct"/>
<th:block th:replace="layout/script :: script"/>


<script>

    const page = {
        urls: {
            getAllProducts: AppBase.API_PRODUCT,
            getAllProductsPage: AppBase.API_PRODUCT,
            getAllProductsPageSearch: AppBase.API_PRODUCT,
            getProductByFilter: AppBase.API_FILTER,
            getProductById: AppBase.API_PRODUCT,
            updateProduct: AppBase.API_PRODUCT,
            deleteProduct: AppBase.API_PRODUCT + "/delete",
            createProduct: AppBase.API_PRODUCT,
            getAllCategory : AppBase.API_CATEGORY,
            searchProduct : AppBase.API_SEARCH,
        },
        elements: {},
        loadData: {},
        commands: {},
        dialogs: {
            elements: {},
            loadData: {},
            commands: {},
            alertDanger: {}
        },
        initializeEventControl: {}
    }

    let product = new Product();
    let productAvatar = new ProductAvatar();
    let category = new Category();

    let countFruit = 0;
    let countVegetable = 0;
    let countMeat = 0;
    let countJuice = 0;
    let countSeafood = 0;
    let totalFood = 0;
    let currentPageNumber = 0;
    let totalPages = 0;

    page.elements.tbTbody = $('#listProduct tbody')
    page.dialogs.elements.nameProductCre = $("#nameProductCre");
    page.dialogs.elements.priceCre = $("#priceCre");
    page.dialogs.elements.quantityCre = $("#quantityCre");
    page.dialogs.elements.categoryCre = $("#categoryCre");
    page.dialogs.elements.descriptionCre = $("#descriptionCre");
    page.dialogs.elements.btnCreate = $("#btnCreate");
    page.dialogs.elements.modalCreateProduct = $("#modalCreateProduct")
    page.dialogs.elements.frmCreateProduct = $("#frmCreateProduct");
    page.dialogs.elements.wrapper = $("#frmCreateProduct .wrapper-images");
    page.dialogs.elements.wrapperContent = $("#frmCreateProduct .wrapper-images .content");
    page.dialogs.elements.imagePreview = $("#frmCreateProduct .image-preview canvas");
    page.dialogs.elements.canvasCre = $("#canvasCre");
    page.dialogs.elements.imageFileCre = $("#imageFileCre");
    page.dialogs.elements.context = page.dialogs.elements.canvasCre[0].getContext('2d');
    page.dialogs.elements.imagePreview.css("display", "none");
    page.dialogs.elements.divImagePreview = $("#frmCreateProduct div.image-preview, #frmCreateProduct div.file-name");
    page.dialogs.elements.btnClearImagePreview = $(".clear-image-preview i");

    page.dialogs.alertDanger.frmCreateProduct = $("#frmCreateProduct .frm-alert-danger");



    page.dialogs.elements.nameProductUp = $("#nameProductUp");
    page.dialogs.elements.priceUp = $("#priceUp");
    page.dialogs.elements.quantityUp = $("#quantityUp");
    page.dialogs.elements.categoryUp = $("#categoryUp");
    page.dialogs.elements.descriptionUp = $("#descriptionUp");
    page.dialogs.elements.btnUpdate = $("#btnUpdate");
    page.dialogs.elements.modalUpdateProduct = $("#modalUpdateProduct")
    page.dialogs.elements.frmUpdateProduct = $("#frmUpdateProduct");
    page.dialogs.elements.wrapperUp = $("#frmUpdateProduct .wrapper-imagesUp");
    page.dialogs.elements.wrapperContentUp = $("#frmUpdateProduct .wrapper-imagesUp .contentUp");
    page.dialogs.elements.imagePreviewUp = $("#frmUpdateProduct .image-previewUp canvas");
    page.dialogs.elements.canvasUp = $("#canvasUp");
    page.dialogs.elements.imageFileUp = $("#imageFileUp");
    page.dialogs.elements.contextUp = page.dialogs.elements.canvasUp[0].getContext('2d');
    page.dialogs.elements.imagePreviewUp.css("display", "none");
    page.dialogs.elements.divImagePreviewUp = $("#frmUpdateProduct div.image-previewUp, #frmUpdateProduct div.file-nameUp");
    page.dialogs.elements.btnClearImagePreviewUp = $(".clear-image-previewUp i");
    page.dialogs.alertDanger.frmUpdateProduct = $("#frmUpdateProduct .frm-alert-danger");

    page.elements.loader = $(".loaderModal");

    page.dialogs.elements.filter = $("#filter");



    page.dialogs.elements.btnSearch = $('#btnSearch');
    page.dialogs.elements.search = $('#search');

    page.dialogs.elements.countProduct = $('#countProduct')

    page.elements.divCountFruit = $('#div-count-fruit');

    page.dialogs.elements.countFruit = $('#countFruit')
    page.dialogs.elements.countVegetable = $('#countVegetable')
    page.dialogs.elements.countMeat = $('#countMeat')
    page.dialogs.elements.countJuice = $('#countJuice')
    page.dialogs.elements.countSeaFood = $('#countSeaFood')
    page.dialogs.elements.countTotalFood = $('#countTotalFood')

    page.loadData.countProduct = () => {

        $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
            url: page.urls.getAllProductsPage + "/total"
        })
            .done((data) => {


                $.each(data, (i, item) => {
                    product = item;
                    category = product.category;
                    page.commands.count();
                });
                totalFood = +(countFruit + countVegetable + countMeat + countJuice + countSeafood);
                page.commands.handleRenderCount();
            })
            .fail((error) => {
                console.log(error);
            })
    }

    page.loadData.getAllProductByPaginationAndSearch = (keySearch) => {

        $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
            url: page.urls.getAllProductsPageSearch + '?keySearch=' + keySearch + '&page=' + currentPageNumber
        })
            .done((data) => {
                page.elements.tbTbody.empty();
                $('ul.pagination').empty()
                let products = data.content;

                let pageable = data.pageable;
                totalPages = data.totalPages;
                let str = page.commands.renderPagination(pageable, totalPages);
                $('ul.pagination').append(str);

                $.each(products, (i, item) => {
                    product = item;
                    productAvatar = product.productAvatar;
                    category = product.category;

                    page.elements.tbTbody.append(page.commands.renderProduct(product, productAvatar, category));
                });

                page.commands.handleAddEventPageLink();
                page.commands.removeHandleShowModal();
                page.commands.handleShowGroupModal();
            })
            .fail((error) => {
                console.log(error);
            })
    }

    // page.loadData.getAllProductByPaginationAndSearch = (pageNumber) => {
    //
    //     $.ajax({
    //         headers: {
    //             "accept": "application/json",
    //             "content-type": "application/json"
    //         },
    //         type: "GET",
    //         url: page.urls.getAllProductsPageSearch + '?page=' + pageNumber
    //     })
    //         .done((data) => {
    //             page.elements.tbTbody.empty();
    //             let products = data.content;
    //
    //             $.each(products, (i, item) => {
    //                 product = item;
    //                 productAvatar = product.productAvatar;
    //                 category = product.category;
    //                 page.commands.count();
    //                 page.elements.tbTbody.append(page.commands.renderProduct(product, productAvatar, category));
    //             });
    //
    //             totalFood = +(countFruit + countVegetable + countMeat + countJuice + countSeafood);
    //
    //             let pageable = data.pageable;
    //             let totalPages = data.totalPages;
    //             let str = page.commands.renderPagination(pageable, totalPages);
    //             $('ul.pagination').empty().append(str);
    //
    //             page.commands.handleAddEventPageLink();
    //
    //             page.commands.handleRenderCount();
    //             page.commands.removeHandleShowModal();
    //             page.commands.handleShowGroupModal();
    //             page.commands.handleSearchAndFilter();
    //         })
    //         .fail((error) => {
    //             console.log(error);
    //         })
    // }

    page.loadData.getProductByFilter = () => {

        $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
            url: page.urls.getProductByFilter + '?page=' + currentPageNumber
        })
            .done((data) => {
                page.elements.tbTbody.empty();
                let products = data.content;
                let pageable = data.pageable;
                totalPages = data.totalPages;
                let str = page.commands.renderPagination(pageable, totalPages);

                $('ul.pagination').empty().append(str);

                $.each(products, (i, item) => {
                    product = item;
                    productAvatar = product.productAvatar;
                    category = product.category;
                    page.elements.tbTbody.append(page.commands.renderProduct(product, productAvatar, category));
                });

                page.commands.handleAddEventPageLinkFilter();
                page.commands.removeHandleShowModal();
                page.commands.handleShowGroupModal();
                page.commands.handleSearchAndFilter();
            })
            .fail((error) => {
                console.log(error);
            })
    }




    page.commands.handleShowCreateModal = () => {
        $('.create').on("click", function () {
            page.dialogs.elements.modalCreateProduct.modal('show');
        })
    }

    page.commands.renderCountProduct = (count) => {
        return `<h4><b>${count} dishes</b></h4>`;
    }

    page.commands.count = () => {
        if(category.id == 1){
            countFruit += 1;
        }
        if(category.id ==2){
            countVegetable += 1;
        }
        if(category.id ==3){
            countMeat += 1;
        }
        if(category.id == 4){
            countJuice +=1;
        }
        if(category.id ==5){
            countSeafood +=1;
        }
    }

    page.commands.renderCountFruit = () => {
        return `
            <div class="col-sm-6 col-md-6 col-lg-2">
                <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                    <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                            <i class="ri-focus-2-line"></i>
                        </div>
                        <p class="text-secondary">Total Fruits</p>
                        <div class="d-flex align-items-center justify-content-between" id="countFruit">
                            <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countFruit.jpg">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-6 col-lg-2">
                <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                    <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                            <i class="ri-focus-2-line"></i>
                        </div>
                        <p class="text-secondary">Total Vegetables</p>
                        <div class="d-flex align-items-center justify-content-between" id="countVegetable">
                            <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countVegetable.jpg" >

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-6 col-lg-2">
                <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                    <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                            <i class="ri-focus-2-line"></i>
                        </div>
                        <p class="text-secondary">Total Meats</p>
                        <div class="d-flex align-items-center justify-content-between" id="countMeat">
                            <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countMeat.jpg" >

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-6 col-lg-2">
                <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                    <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                            <i class="ri-focus-2-line"></i>
                        </div>
                        <p class="text-secondary">Total Juices</p>
                        <div class="d-flex align-items-center justify-content-between" id="countJuice">
                            <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countJuice.jpg" >

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-6 col-lg-2">
                <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                    <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                            <i class="ri-focus-2-line"></i>
                        </div>
                        <p class="text-secondary">Total SeaFoods</p>
                        <div class="d-flex align-items-center justify-content-between" id="countSeaFood">
                            <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/countSeaFood.jpg">

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-6 col-lg-2">
                <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                    <div class="iq-card-body iq-box-relative">
                        <div class="iq-box-absolute icon iq-icon-box rounded-circle iq-bg-primary">
                            <i class="ri-focus-2-line"></i>
                        </div>
                        <p class="text-secondary">Total Products</p>
                        <div class="d-flex align-items-center justify-content-between" id="countTotalFood">
                            <img class="img-fluid" style="width: 120px; height: 90px" src="/assets/assetsCP/anh/logo.png">
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    page.commands.handleRenderCount = () => {
        page.dialogs.elements.countFruit.empty();
        page.dialogs.elements.countVegetable.empty();
        page.dialogs.elements.countMeat.empty();
        page.dialogs.elements.countJuice.empty();
        page.dialogs.elements.countSeaFood.empty();
        page.dialogs.elements.countTotalFood.empty();

        // let str = page.commands.renderCountFruit();
        // page.elements.divCountFruit.html(str);

        // $('#countFruit').prepend(page.commands.renderCountProduct(countFruit));

        page.dialogs.elements.countFruit.append(page.commands.renderCountProduct(countFruit));
        page.dialogs.elements.countVegetable.append(page.commands.renderCountProduct(countVegetable));
        page.dialogs.elements.countMeat.append(page.commands.renderCountProduct(countMeat));
        page.dialogs.elements.countJuice.append(page.commands.renderCountProduct(countJuice));
        page.dialogs.elements.countSeaFood.append(page.commands.renderCountProduct(countSeafood));
        page.dialogs.elements.countTotalFood.append(page.commands.renderCountProduct(totalFood));
    }

    page.commands.renderProduct = (product, productAvatar, category) => {

        let image_thumbnail = `${AppBase.BASE_URL_CLOUD_IMAGE}/${AppBase.SCALE_IMAGE_W100_H80_Q100}/${productAvatar.fileFolder}/${productAvatar.fileName}`;
        return `
                   <tr id="tr_${product.id}">
                        <td class="text-center">${product.id}</td>
                        <td class="text-center"><img class="img-fluid" src="${image_thumbnail}" alt=""${productAvatar.fileName}""></td>
                        <td class="text-center">${product.nameProduct}</td>
                        <td class="text-center">${new Intl.NumberFormat('vi-VN', {
            style: 'currency',
            currency: 'VND'
        }).format(product.price)}</td>
                        <td class="text-center">
                            ${product.quantity}
                        </td >
                        <td class="text-center">
                            ${category.title}
                        </td>
                        <td class="text-center">${product.description}</td>
                        <td class="align-items-center">
                            <div class="iq-card-header-toolbar d-flex align-items-center">
                            <div class="dropdown">
                            <span class="dropdown-toggle text-primary" id="dropdownMenuButton5" data-toggle="dropdown" >
                            <i class="ri-more-fill "></i>
                             </span>
                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton5">
                                    <a class="dropdown-item delete" data-id=${product.id}
                                                                    data-avatar-id = "${productAvatar.id}"
                                                                    data-avatar-file-folder = "${productAvatar.fileFolder}"
                                                                    data-avatar-file-name = "${productAvatar.fileName}"
                                                                    href="#"  ><i class="ri-delete-bin-6-fill mr-2"></i>Delete</a>
                                    <button class="dropdown-item update" data-id=${product.id}
                                                                    data-avatar-id = "${productAvatar.id}"
                                                                    data-avatar-file-folder = "${productAvatar.fileFolder}"
                                                                    data-avatar-file-name = "${productAvatar.fileName}" href="#"><i class="ri-pencil-fill mr-2"></i>Update</button>
                                </div>
                            </div>
                        </div>
                        </td>
                    </tr>
        `;
    }


    page.dialogs.elements.frmCreateProduct.validate({
        rules: {
            nameProductCre: {
                required: true,
                minlength: 5,
                maxlength: 50
            },
            priceCre: {
                required: true,
                min: 100000,
                max: 999999999,
                number: true
            },
            quantityCre: {
                required: true,
                min: 1,
                max: 999999,
                number: true
            },
            categoryCre: {
                required: true,
                min: 1,
                max: 5,
                number: true
            },
            descriptionCre: {
                required: true,
                minlength: 5,
                maxlength: 200
            }
        },
        messages: {
            nameProductCre: {
                required: "Vui lòng nhập tên sản phẩm.",
                minlength: "Tên sản phẩm có độ dài tối thiểu là 5 ký tự.",
                maxlength: "Tên sản phẩm có độ dài tối đa là 100 ký tự."
            },
            priceCre: {
                required: "Vui lòng nhập giá.",
                min: "Giá sản phẩm tối thiểu là 100.000 VNĐ.",
                max: "Giá sản phẩm tối đa là 999.999.999 VNĐ.",
                number: "Giá sản phẩm phải là số."
            },
            quantityCre: {
                required: "Vui lòng nhập số lượng.",
                min: "Số lượng tối thiểu là 1 sản phẩm.",
                max: "Số lượng tối thiểu là 999.999 sản phẩm.",
                number: "Số lượng phải là số."
            },
            categoryCre: {
                required: "Vui lòng nhập loại sản phâ.",
                min: "mã sản phẩm không đúng. vui lòng nhập lại.",
                max: "mã sản phẩm không đúng. vui lòng nhập lại.",
                number: "mã sản phẩm không đúng. vui lòng nhập lại."
            },
            descriptionCre: {
                required: "Vui lòng nhập mô tả.",
                minlength: "Mô tả có độ dài tối thiểu là 5 ký tự.",
                maxlength: "Mô tả có độ dài tối đa là 200 ký tự."
            }
        },
        errorLabelContainer: "#frmCreateProduct .frm-alert-danger",
        showErrors: function () {
            if (this.numberOfInvalids() > 0) {
                page.dialogs.alertDanger.frmCreateProduct.removeClass("hide").addClass("show");
            } else {
                page.dialogs.alertDanger.frmCreateProduct.removeClass("show").addClass("hide").empty();
            }
            this.defaultShowErrors();
        },
        submitHandler: function () {
            let product = {};
            product.nameProduct = page.dialogs.elements.nameProductCre.val().trim();
            product.price = page.dialogs.elements.priceCre.val().trim();
            product.quantity = page.dialogs.elements.quantityCre.val().trim();
            category.id = +page.dialogs.elements.categoryCre.val().trim();
            category.title = page.dialogs.elements.categoryCre.find("option:selected").text();
            product.description = page.dialogs.elements.descriptionCre.val().trim();
            let formData = new FormData();
            formData.append("nameProduct", product.nameProduct);
            formData.append("price", product.price);
            formData.append("quantity", product.quantity);
            formData.append("categoryId", category.id)
            formData.append("title", category.title);
            formData.append("description", product.description);
            formData.append("file", page.dialogs.elements.imageFileCre[0].files[0]);
            page.commands.createProduct(formData);
        }
    })

    page.commands.createProduct = (formData) => {
        page.commands.showLoading();
        $.ajax({
            type: "POST",
            contentType: false,
            cache: false,
            processData: false,
            url: page.urls.createProduct,
            data: formData
        })
            .done((data) => {
                product = data;
                productAvatar = product.productAvatar;
                category = product.category;
                page.commands.count();
                totalFood = +(countFruit + countVegetable + countMeat + countJuice + countSeafood);
                page.dialogs.elements.frmCreateProduct[0].reset();
                page.dialogs.elements.clearImagePreview();
                Swal.fire({
                    position: 'top-end',
                    icon: 'success',
                    title: "Thêm mới sản phẩm <b>" + product.nameProduct + "</b> thành công.",
                    showConfirmButton: false,
                    timer: 2000
                })

                if (currentPageNumber === 0) {
                    // $('#listProduct tbody tr:eq(4)').remove();
                    // page.elements.tbTbody.prepend(page.commands.renderProduct(product, productAvatar, category));
                    let keySearch = page.dialogs.elements.search.val();
                    page.loadData.getAllProductByPaginationAndSearch(keySearch);
                }

                page.loadData.countProduct();
                page.commands.removeHandleShowModal();
                page.commands.handleShowGroupModal();
                page.commands.handleSearchAndFilter();
                page.dialogs.elements.modalCreateProduct.modal('hide');
            })
            .fail((jqXHR) => {
                console.log(jqXHR)
                let str = ``;
                if (jqXHR.status === 401) {
                    AppBase.SweetAlert.showError401();
                } else {
                    if (jqXHR.status === 403) {
                        AppBase.SweetAlert.showError403();
                    } else {
                        if (jqXHR.responseJSON) {
                            if (jqXHR.responseJSON.message) {
                                str += `<label id="message-error" class="error" for="message">${jqXHR.responseJSON.message}</label>`;
                            } else {
                                $.each(jqXHR.responseJSON, function (key, value) {
                                    str += `<label id="${key}-error" class="error" for="${key}">${value}</label>`;
                                    $("#" + key).addClass("error");
                                });
                            }
                            page.dialogs.alertDanger.frmCreateProduct.removeClass("hide").addClass("show");
                            page.dialogs.alertDanger.frmCreateProduct.css("display", "block")
                            page.dialogs.alertDanger.frmCreateProduct.append(str);
                        } else {
                            AppBase.SweetAlert.showError500();
                        }
                    }
                }
            }).always(function () {
            page.commands.closeLoading();
        })
    }

    page.dialogs.elements.btnCreate.on("click", () => {
        page.dialogs.elements.frmCreateProduct.trigger("submit");
    })

    page.commands.getProductById = (productId) => {
        return $.ajax({
            type: "GET",
            url: page.urls.getProductById + "/" + productId
        }).done((data) => {
            product = data;
        })
            .fail((jqXHR) => {
                let errors = jqXHR.responseJSON;
                if (errors) {
                    let str = "";
                    $.each(errors, (k, v) => {
                        str += `
                            ${v}
                        `;
                    })
                    AppBase.SweetAlert.showErrorAlert(str);
                }
            })
    }

    // ---------UpDate--------

    page.commands.getAllCategory = () => {
        return $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
            url: page.urls.getAllCategory
        })
            .done((data) => {
                let categories = data;

                $.each(categories, (i, item) => {
                    let str = `<option value="${item.id}">${item.id} - ${item.title}</option>`;
                    page.dialogs.elements.categoryUp.append(str);
                })

            })
            .fail((error) => {
                console.log(error);
                console.log("Không thể tải dữ liệu Tỉnh/Thành phố");
            })
    }

    page.commands.handleShowUpdateModal = () => {
        $(".update").on("click", function () {
            let id = $(this).data("id");
            let avatarFileFolder = $(this).data("avatar-file-folder");
            let avatarFileName = $(this).data("avatar-file-name");
            page.commands.getProductById(id).done((data) => {
                let avatarUrl = AppBase.BASE_URL_CLOUD_IMAGE + "/" + AppBase.SCALE_IMAGE_W600_H850_Q100 + "/" + avatarFileFolder + "/" + avatarFileName;
                page.dialogs.commands.loadImageToCanvasUpdate(null, "", avatarUrl);
                product = data;
                category = product.category;
                productAvatar = product.productAvatar;

                page.dialogs.elements.nameProductUp.val(product.nameProduct);
                page.dialogs.elements.priceUp.val(product.price);
                page.dialogs.elements.quantityUp.val(product.quantity);
                page.commands.getAllCategory().then(() => {
                    page.dialogs.elements.categoryUp.val(category.id);
                })
                page.dialogs.elements.descriptionUp.val(product.description);
                page.dialogs.elements.modalUpdateProduct.modal('show');
            })
        })
    }

    page.dialogs.elements.frmUpdateProduct.validate({
        rules: {
            nameProductUp: {
                required: true,
                minlength: 5,
                maxlength: 50
            },
            priceUp: {
                required: true,
                min: 100000,
                max: 999999999,
                number: true
            },
            quantityUp: {
                required: true,
                min: 1,
                max: 999999,
                number: true
            },
            categoryUp: {
                required: true,
                min: 1,
                max: 5,
                number: true
            },
            descriptionUp: {
                required: true,
                minlength: 5,
                maxlength: 200
            }
        },
        messages: {
            nameProductUp: {
                required: "Vui lòng nhập tên sản phẩm.",
                minlength: "Tên sản phẩm có độ dài tối thiểu là 5 ký tự.",
                maxlength: "Tên sản phẩm có độ dài tối đa là 100 ký tự."
            },
            priceUp: {
                required: "Vui lòng nhập giá.",
                min: "Giá sản phẩm tối thiểu là 100.000 VNĐ.",
                max: "Giá sản phẩm tối đa là 999.999.999 VNĐ.",
                number: "Giá sản phẩm phải là số."
            },
            quantityUp: {
                required: "Vui lòng nhập số lượng.",
                min: "Số lượng tối thiểu là 1 sản phẩm.",
                max: "Số lượng tối thiểu là 999.999 sản phẩm.",
                number: "Số lượng phải là số."
            },
            categoryUp: {
                required: "Vui lòng nhập loại sản phâ.",
                min: "mã sản phẩm không đúng. vui lòng nhập lại.",
                max: "mã sản phẩm không đúng. vui lòng nhập lại.",
                number: "mã sản phẩm không đúng. vui lòng nhập lại."
            },
            descriptionUp: {
                required: "Vui lòng nhập mô tả.",
                minlength: "Mô tả có độ dài tối thiểu là 5 ký tự.",
                maxlength: "Mô tả có độ dài tối đa là 200 ký tự."
            }
        },
        errorLabelContainer: "#frmUpdate .frm-alert-danger"
        ,
        showErrors: function () {
            if (this.numberOfInvalids() > 0) {
                page.dialogs.alertDanger.frmUpdateProduct.removeClass("hide").addClass("show");
            } else {
                page.dialogs.alertDanger.frmUpdateProduct.removeClass("show").addClass("hide").empty();
                $("#frmUpdate input.error").removeClass("error");
            }
            this.defaultShowErrors();
        },
        submitHandler: function () {
            product.nameProduct = page.dialogs.elements.nameProductUp.val().trim();
            product.price = page.dialogs.elements.priceUp.val().trim();
            product.quantity = page.dialogs.elements.quantityUp.val().trim();
            category.id = +page.dialogs.elements.categoryUp.val().trim();
            category.title = page.dialogs.elements.categoryUp.find("option:selected").text();
            product.description = page.dialogs.elements.descriptionUp.val().trim();
            let formData = new FormData();
            formData.append("nameProduct", product.nameProduct);
            formData.append("price", product.price);
            formData.append("quantity", product.quantity);
            formData.append("categoryId", category.id);
            formData.append("title", category.title);
            formData.append("description", product.description);
            formData.append("file", page.dialogs.elements.imageFileUp[0].files[0]);
            page.commands.doUpdateProduct(formData);
        }
    })


    page.commands.doUpdateProduct = (formData) => {
        page.commands.showLoading();
        $.ajax({
            type: "PATCH",
            contentType: false,
            cache: false,
            processData: false,
            url: page.urls.updateProduct + "/" + product.id,
            data: formData
        })
            .done((data) => {
                product = data;
                productAvatar = product.productAvatar;
                category = data.category;

                let str = page.commands.renderProduct(product, productAvatar,category);
                let updateRow = $("#tr_" + product.id);
                updateRow.replaceWith(str);
                page.commands.count();
                totalFood = +(countFruit + countVegetable + countMeat + countJuice + countSeafood);
                page.loadData.countProduct();
                page.commands.removeHandleShowModal();
                page.commands.handleShowGroupModal();
                page.commands.handleSearchAndFilter();
                page.dialogs.elements.modalUpdateProduct.modal("hide");
                AppBase.IziToast.showSuccessAlertLeft("Chỉnh sửa sản phẩm <b>'" + product.nameProduct + "'</b> thành công.")
                page.commands.closeLoading();
            }).fail((jqXHR) => {
            let str = ``;
            console.log(jqXHR.status);
            if(jqXHR.status === 400){
                AppBase.SweerAlert.showError400();
            }
            if (jqXHR.status === 401) {
                AppBase.SweetAlert.showError401();
            } else {
                if (jqXHR.status === 403) {
                    AppBase.SweetAlert.showError403();
                } else {
                    if (jqXHR.responseJSON) {
                        if (jqXHR.responseJSON.message) {
                            str += `<label id="message-error" class="error" for="message">${jqXHR.responseJSON.message}</label>`;
                        } else {
                            $.each(jqXHR.responseJSON, function (key, value) {
                                str += `<label id="${key}-error" class="error" for="${key}>${value}</label>`;
                                $("#" + key).addClass("error");
                            });
                        }
                        page.dialogs.alertDanger.frmUpdateProduct.removeClass("hide").addClass("show");
                        page.dialogs.alertDanger.frmUpdateProduct.css("display", "block")
                        page.dialogs.alertDanger.frmUpdateProduct.append(str);
                    } else {
                        AppBase.SweetAlert.showError500();
                    }
                }
            }

        })
    }

    page.dialogs.commands.loadImageToCanvasUpdate = (imageFile, fileType, imageUrl) => {
        page.dialogs.elements.imagePreviewUp.css("display", "");
        page.dialogs.elements.wrapperUp.addClass("active");
        page.dialogs.elements.wrapperContentUp.css("opacity", 0);

        let imageObj = new Image();

        imageObj.onload = function () {
            page.dialogs.elements.contextUp.canvas.width = imageObj.width;
            page.dialogs.elements.contextUp.canvas.height = imageObj.height;
            page.dialogs.elements.contextUp.drawImage(imageObj, 0, 0, imageObj.width, imageObj.height);
        };
        if (fileType === "BINARY") {
            imageObj.src = URL.createObjectURL(imageFile);
        } else {
            imageObj.src = imageUrl;
        }
    }

    page.dialogs.elements.clearImagePreviewUp = () => {
        page.dialogs.elements.imageFileUp.val("");
        page.dialogs.elements.imagePreviewUp.css("display", "none");
        page.dialogs.elements.wrapperUp.removeClass("active");
        page.dialogs.elements.wrapperContentUp.css("opacity", 1);
    }

    page.dialogs.commands.changeImagePreviewUp = () => {
        let imageFile = page.dialogs.elements.imageFileUp[0].files[0];
        if (imageFile) {
            let reader = new FileReader();
            reader.readAsDataURL(imageFile);
            reader.onload = function (e) {
                if (e.target.readyState === FileReader.DONE) {
                    page.dialogs.commands.loadImageToCanvasUpdate(imageFile, "BINARY", null);
                }
            }
        } else {
            page.dialogs.elements.clearImagePreviewUp();
        }
    }

    page.dialogs.elements.imageFileCre.on("change", function () {
        page.dialogs.commands.changeImagePreviewUp();
    });

    // ------End Update------

    page.commands.closeLoading = () => {
        $('.loading-button').addClass('hide');
        page.elements.loader.addClass("hide");
        page.dialogs.elements.btnCreate.prop('disabled', false);
        page.dialogs.elements.btnUpdate.prop('disabled', false);
    }

    page.commands.showLoading = () => {
        $('.loading-button').removeClass('hide');
        page.elements.loader.removeClass("hide");
        page.dialogs.elements.btnCreate.prop('disabled', true);
        page.dialogs.elements.btnUpdate.prop('disabled', true);
    }

    page.dialogs.commands.loadImageToCanvasUp = (imageFile, fileType, imageUrl) => {
        page.dialogs.elements.imagePreview.css("display", "");
        page.dialogs.elements.wrapper.addClass("active");
        page.dialogs.elements.wrapperContent.css("opacity", 0);

        let imageObj = new Image();

        imageObj.onload = function () {
            page.dialogs.elements.context.canvas.width = imageObj.width;
            page.dialogs.elements.context.canvas.height = imageObj.height;
            page.dialogs.elements.context.drawImage(imageObj, 0, 0, imageObj.width, imageObj.height);
        };
        if (fileType === "BINARY") {
            imageObj.src = URL.createObjectURL(imageFile);
        } else {
            imageObj.src = imageUrl;
        }
    }

    page.dialogs.elements.clearImagePreview = () => {
        page.dialogs.elements.imageFileCre.val("");
        page.dialogs.elements.imagePreview.css("display", "none");
        page.dialogs.elements.wrapper.removeClass("active");
        page.dialogs.elements.wrapperContent.css("opacity", 1);
    }

    page.dialogs.commands.changeImagePreview = () => {
        let imageFile = page.dialogs.elements.imageFileCre[0].files[0];
        if (imageFile) {
            let reader = new FileReader();
            reader.readAsDataURL(imageFile);
            reader.onload = function (e) {
                if (e.target.readyState === FileReader.DONE) {
                    page.dialogs.commands.loadImageToCanvasUp(imageFile, "BINARY", null);
                }
            }
        } else {
            page.dialogs.elements.clearImagePreview();
        }
    }

    page.dialogs.elements.imageFileCre.on("change", function () {
        page.dialogs.commands.changeImagePreview();
    });
    // ----------------DELETE--------------

    page.commands.handleShowConfirmDelete = () => {
        $(".delete").on("click", function () {
            let id = $(this).data("id");
            page.commands.getProductById(id).then(() => {
                Swal.fire({
                    title: 'Bạn có chắc chắn muốn xóa?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Đồng ý!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        page.commands.doDeleteCustomer(id);
                    }
                })
            })
        });
    }

    page.commands.doDeleteCustomer = (productId) => {
        $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "DELETE",
            url: page.urls.deleteProduct + "/" + productId,
            data: JSON.stringify(productId)
        })
            .done(() => {


                page.loadData.countProduct();
                page.commands.removeHandleShowModal();
                page.commands.handleShowGroupModal();
                page.commands.handleSearchAndFilter();

                let keySearch = page.dialogs.elements.search.val();
                let rows = $('#listProduct tbody tr').length;

                if (rows === 1) {
                    currentPageNumber = 0;
                    page.loadData.getAllProductByPaginationAndSearch(keySearch);
                }
                else {
                    if ((currentPageNumber + 1) === totalPages) {
                        $("#tr_" + productId).remove();
                    }
                    else {
                        page.loadData.getAllProductByPaginationAndSearch(keySearch);
                    }
                }
                AppBase.IziToast.showSuccessAlertLeft("Xóa Sản Phẩm <b>'" + product.nameProduct + "'</b> thành công");
            })
            .fail((jqXHR) => {
                if(jqXHR.status === 400){
                    AppBase.SweetAlert.showError400();
                }
                if (jqXHR.status === 401) {
                    AppBase.SweetAlert.showError401();
                } else {
                    if (jqXHR.status === 403) {
                        AppBase.SweetAlert.showError403();
                    } else {
                        if (jqXHR.responseJSON) {
                            console.log(jqXHR.responseJSON.message)
                            AppBase.SweetAlert.showErrorAlert(jqXHR.responseJSON.message);
                        } else {
                            AppBase.SweetAlert.showError500();
                        }
                    }
                }
            })
    }

    // --------------END DELETE----------

    //     ----------------Filter------------
    page.commands.getAllCategoryFilter = () => {
        return $.ajax({
            headers: {
                "accept": "application/json",
                "content-type": "application/json"
            },
            type: "GET",
            url: page.urls.getAllCategory
        })
            .done((data) => {
                let categories = data;
                let str = `<option value=-1>All Foods</option>`;
                page.dialogs.elements.filter.append(str);
                $.each(categories, (i, item) => {
                    let str = `<option value="${item.id}">${item.id} - ${item.title}</option>`;
                    page.dialogs.elements.filter.append(str);
                })


            })
            .fail((error) => {
                console.log(error);
                console.log("Không thể tải dữ liệu Danh Mục");
            })
    }

    page.commands.doFilter = () => {
        let categoryId = +page.dialogs.elements.filter.val();
        $.ajax({
            type: "GET",
            url: page.urls.getProductByFilter + '?categoryId=' + categoryId + '&page=' + currentPageNumber
        })
            .done((data) => {

                page.elements.tbTbody.empty();
                let products = data.content;
                let pageable = data.pageable;
                let totalPages = data.totalPages;
                let str = page.commands.renderPagination(pageable, totalPages);
                $('ul.pagination').empty().append(str);

                page.commands.handleAddEventPageLinkFilter();

                $.each(products, (i, item) => {
                    product = item;
                    productAvatar = product.productAvatar;
                    category = product.category;
                    page.elements.tbTbody.prepend(page.commands.renderProduct(product, productAvatar, category));
                });

                page.commands.removeHandleShowModal();
                page.commands.handleShowGroupModal();
                page.commands.handleSearchAndFilter();
            })
            .fail((error) => {
                console.log(error);
            })
    }


    //     ----------------End Filter-------------


    page.commands.handleAddEventSearch = () => {
        page.dialogs.elements.btnSearch.on("click", function () {
            let keySearch = page.dialogs.elements.search.val();
            page.loadData.getAllProductByPaginationAndSearch(keySearch);
            // page.commands.doSearch();
        })
    }

    // page.commands.renderLoadingBtn = () => {
    //     return `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
    //         <span class="sr-only">Loading...</span>`
    // }

    // -----------Search-----------
    // page.commands.doSearch = () => {
    //     let keySearch = page.dialogs.elements.search.val();
    //     $.ajax({
    //         type: "GET",
    //         url: page.urls.searchProduct + '?keySearch=' + keySearch + '&page=' + currentPageNumber
    //     })
    //         .done((data) => {
    //             console.log(currentPageNumber)
    //             let products = data.content;
    //             page.elements.tbTbody.empty();
    //             $.each(products, (i, item) => {
    //                 product = item;
    //                 productAvatar = product.productAvatar;
    //                 category = product.category;
    //                 page.elements.tbTbody.append(page.commands.renderProduct(product, productAvatar, category));
    //             });
    //
    //
    //             let pageable = data.pageable;
    //             let totalPages = data.totalPages;
    //             let str = page.commands.renderPagination(pageable, totalPages);
    //             $('ul.pagination').empty().append(str);
    //
    //             page.commands.handleRenderCount();
    //             page.commands.removeHandleShowModal();
    //             page.commands.handleShowGroupModal();
    //             page.commands.handleSearchAndFilter();
    //         })
    //         .fail((error) => {
    //             console.log(error);
    //         })
    //
    // }


    // --------------End Search------------

    // -------------handle------------
    page.commands.handleSearchAndFilter = () => {
        page.dialogs.elements.filter.on("change", function () {
            page.commands.doFilter();
        })
    }

    page.commands.handleShowGroupModal = () => {
        page.commands.handleShowConfirmDelete();
        page.commands.handleShowUpdateModal();

    }
    page.commands.removeHandleShowModal = () => {
        $(".edit").off("click");
        $(".delete").off("click");
    }

    page.dialogs.commands.handleCloseCreateModal = () => {
        page.dialogs.alertDanger.frmCreateProduct.removeClass("show").addClass("hide").empty();
        page.dialogs.elements.frmCreateProduct[0].reset();
        page.dialogs.elements.frmCreateProduct.validate().resetForm();
    }

    page.dialogs.commands.handleCloseUpdateModal = () => {
        page.dialogs.alertDanger.frmUpdateProduct.removeClass("show").addClass("hide").empty();
        page.dialogs.elements.frmUpdateProduct[0].reset();
        page.dialogs.elements.frmUpdateProduct.validate().resetForm();
    }

    page.commands.renderPagination = (pageable, totalPages) => {
        let str = `
            <li class="page-item disabled">
                <span class="page-link">Previous</span>
            </li>
        `;

        for (let i = 1; i <= totalPages; i++) {
            if ((i - 1) === pageable.pageNumber) {
                str += `
                    <li class="page-item active">
                        <span class="page-link">${i}
                        <span class="sr-only">(current)</span>
                     </span>
                    </li>
                `;
            }
            else {
                str += `
                    <li class="page-item">
                        <button class="page-link" data-page="${i-1}">${i}</button>
                    </li>
                `;
            }
        }

        str += `
            <li class="page-item">
                <a class="page-link" href="#">Next</a>
            </li>
        `;

        return str;
    }


    page.commands.handleAddEventPageLink = () => {
        $('.page-link').on('click', function () {
            let pageNumber = $(this).data('page');
            currentPageNumber = pageNumber;
            let keySearch = page.dialogs.elements.search.val();
            page.loadData.getAllProductByPaginationAndSearch(keySearch);
            // page.commands.doSearch();
        })
    }

    page.commands.handleAddEventPageLinkFilter = () => {
        $('.page-link').on('click', function () {
            let pageNumber = $(this).data('page');
            console.log('pageNumber = ' + pageNumber)
            currentPageNumber = pageNumber;
            page.commands.doFilter();
        })
    }


    // page.commands.handleAddEventPageLinkAndSearch = () => {
    //     $('.page-link').on('click', function () {
    //         let pageNumber = $(this).data('page');
    //         currentPageNumber = pageNumber;
    //         page.loadData.getAllProductByPaginationAndSearch(pageNumber);
    //     })
    // }


    // ----------------end handle-----------



    page.initializeEventControl = () => {
        page.dialogs.elements.btnUpdate.on("click", () => {
            page.dialogs.elements.frmUpdateProduct.submit();
        });

        page.dialogs.elements.divImagePreview.on("click", function () {
            page.dialogs.elements.imageFileCre.trigger("click");
        });
        page.dialogs.elements.divImagePreviewUp.on("click", function () {
            page.dialogs.elements.imageFileUp.trigger("click");
        });
        page.dialogs.elements.imageFileCre.on("change", function () {
            page.dialogs.commands.changeImagePreview();
        });
        page.dialogs.elements.imageFileUp.on("change", function () {
            page.dialogs.commands.changeImagePreviewUp();
        });
        // page.dialogs.elements.divImagePreview.on("click", function () {
        //     page.dialogs.elements.imageFile.trigger("click");
        // });

        page.dialogs.elements.btnClearImagePreview.on("click", function () {
            page.dialogs.elements.clearImagePreview();
        });
        page.dialogs.elements.btnClearImagePreviewUp.on("click", function () {
            page.dialogs.elements.clearImagePreviewUp();
        });
        page.dialogs.elements.modalCreateProduct.on("hidden.bs.modal", function () {
            page.dialogs.commands.handleCloseCreateModal();
        });
        page.dialogs.elements.modalUpdateProduct.on("hidden.bs.modal", function () {
            page.dialogs.commands.handleCloseUpdateModal();
        });

        page.commands.removeHandleShowModal();
        page.commands.handleShowGroupModal();
        page.commands.handleSearchAndFilter();
        page.commands.handleAddEventSearch();
    }


    page.commands.loadData = () => {
        page.commands.closeLoading();
        page.loadData.countProduct();
        page.loadData.getAllProductByPaginationAndSearch(page.dialogs.elements.search.val());
        page.commands.handleShowCreateModal();
        page.commands.getAllCategoryFilter();
    }

    $(() => {
        page.initializeEventControl();
        page.commands.loadData();
    })


</script>
</body>

</html>